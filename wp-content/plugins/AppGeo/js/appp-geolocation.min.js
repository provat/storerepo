window.geo_object=window.geo_object||{ajax_url:apppCore.ajaxurl};(function(b,a,c,e){b.AppGeo={};var d=false;AppGeo.ajaxloaded=false;AppGeo.get=navigator.geolocation;
AppGeo.geoLocate_post=function(){if(d===true&&!AppGeo.ajaxloaded){return;}AppGeo.get.getCurrentPosition(AppGeo.onSuccessGeoPost,AppGeo.onErrorGeo);setInterval(function(){AppGeo.get.getCurrentPosition(AppGeo.onSuccessGeoPost,AppGeo.onErrorGeo);
},15000);d=true;AppGeo.ajaxloaded=false;};AppGeo.onSuccessGeoPost=function(f){if(a.getElementById("appp_longitude")===null||!f){return;}AppGeo.position=f;
apppresser.log("onSuccessGeoPost position",f);var g=null;var i=["longitude","latitude","altitude","accuracy","altitudeAccuracy","heading","speed","timestamp"];
var h=i.length-1;while(h>=0){g=a.getElementById("appp_"+i[h].toLowerCase());if(g){g.value=f.coords[i[h]];}h--;}var j=c("#appp_map_preview_img");if(f&&j.length){j.attr("src","http://maps.googleapis.com/maps/api/staticmap?zoom=17&size=600x300&maptype=roadmap&markers=color:red%7Ccolor:red%7Clabel:%7C"+f.coords.latitude+","+f.coords.longitude+"&sensor=false");
}};AppGeo.onErrorGeo=function(f){if(typeof apppCore.log==="function"){apppCore.log("code: "+f.code+"\nmessage: "+f.message+"\n");}};AppGeo.geoLocate_user=function(){navigator.geolocation.getCurrentPosition(AppGeo.onSuccessGeoUser,AppGeo.onErrorGeo);
};AppGeo.onSuccessGeoUser=function(f){var g=geo_object.ajax_url;var h=apppCore.ReadCookie("Appp_Geolocation");if(!g||h){return;}c.ajax({type:"POST",dataType:"json",url:g,data:{action:"appp_geo_user",longitude:f.coords.longitude,latitude:f.coords.latitude},success:function(i){apppresser.log("onSuccessGeoUser response",i);
}});};AppGeo.init=function(){if(null!==a.getElementById("appgeo-geolocate-post-trigger")){AppGeo.geoLocate_post();}if(null!==a.getElementById("appgeo-geolocate-user-trigger")){AppGeo.geoLocate_user();
setInterval(function(){AppGeo.geoLocate_user();},60000);}};c(a).ready(AppGeo.init).bind("load_ajax_content_done",function(){AppGeo.ajaxloaded=true;AppGeo.init();
});})(window,document,jQuery);